<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¸èª²è©¢å•è«–å£‡</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* ç¢ºä¿é å°¾æ°¸é åœ¨åº•éƒ¨ */
        }

        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        /* å°è¦½åˆ—å®¹å™¨ */
        .navbar {
            background-color: #34495e;
            display: flex;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* å°è¦½åˆ—æ¸…å–® */
        .nav-list {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        /* ä¸»é¸å–®é …ç›® */
        .nav-item {
            position: relative;
        }

        /* ä¸»é¸å–®é€£çµæ¨£å¼ */
        .nav-link {
            display: block;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
            cursor: pointer;
        }

        .nav-link:hover {
            background-color: #2c3e50;
        }

        /* ä¸‹æ‹‰é¸å–®å®¹å™¨ */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #ffffff;
            min-width: 180px; /* ç¨å¾®åŠ å¯¬ä¸€é»ä»¥å…æ–‡å­—æŠ˜è¡Œ */
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 0 0 4px 4px;
        }

        /* ç•¶æ»‘é¼ ç§»é .nav-item æ™‚é¡¯ç¤ºä¸‹æ‹‰é¸å–® */
        .nav-item:hover .dropdown-content {
            display: block;
        }

        /* ä¸‹æ‹‰é¸å–®å…§çš„é€£çµ */
        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
            border-bottom: 1px solid #eee;
            font-size: 0.95em;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
            color: #007bff;
        }

        /* å…§å®¹å€å¡Šå®¹å™¨ (ç‚ºäº†è®“ Footer ç½®åº•) */
        .main-container {
            flex: 1;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }

        /* æ§åˆ¶é¢æ¿èˆ‡æ¨™é¡Œ */
        .control-panel {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: #e8f4fc;
            border-radius: 8px;
            border-left: 5px solid #007bff;
        }

        /* è¨è«–ä¸²åˆ‡æ›å™¨æ¨£å¼ */
        .topic-switcher {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .topic-input {
            padding: 8px 15px;
            border: 1px solid #ccc;
            border-radius: 20px;
            width: 220px;
            outline: none;
        }

        .btn-go {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-go:hover { background-color: #0056b3; }

        .btn-reset {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
        }
        .btn-reset:hover { background-color: #5a6268; }

        /* è«–å£‡æœ¬é«”å®¹å™¨ */
        .forum-wrapper {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* é å°¾æ¨£å¼ */
        footer {
            background-color: #2c3e50;
            color: #bdc3c7;
            text-align: center;
            padding: 30px 20px;
            margin-top: auto;
        }

        footer a { color: #fff; text-decoration: none; }
        footer a:hover { color: #3498db; }
        
        .footer-socials { margin-top: 15px; }
        .footer-socials a { margin: 0 10px; font-size: 1.2em; }
    </style>
</head>
<body>

<header>
    <h1>ğŸš€ é¸èª²å•é¡Œè©¢å•è«–å£‡</h1>
    <p>è§£æ±ºä½ å°èª²ç¨‹çš„æ‰€æœ‰ç–‘å•</p>
</header>

<nav class="navbar">
    <ul class="nav-list">
        <li class="nav-item">
            <a href="?cat=å…¬å‘Š" class="nav-link">ğŸ  é¦–é  (å…¬å‘Š)</a>
        </li>

        <li class="nav-item">
            <span class="nav-link">ğŸ‘¨â€ğŸ«æ•™è‚²å­¸é™¢ğŸ‘¨â€ğŸ« â–¾</span>
            <div class="dropdown-content">
                <a href="?cat=æ•™ç¶“">æ•™è‚²ç¶“ç‡Ÿèˆ‡ç®¡ç†å­¸ç³»</a>
                <a href="?cat=æ•™è‚²">æ•™è‚²å­¸ç³»</a>
                <a href="?cat=å¹¼æ•™">å¹¼å…’èˆ‡å®¶åº­æ•™è‚²å­¸ç³»</a>
                <a href="?cat=ç‰¹æ•™">ç‰¹æ®Šæ•™è‚²å­¸ç³»</a>
                <a href="?cat=å¿ƒè«®">å¿ƒç†èˆ‡è«®å•†å­¸ç³»</a>
                <a href="?cat=ç¤¾ç™¼">ç¤¾æœƒèˆ‡å€åŸŸç™¼å±•å­¸ç³»</a>
            </div>
        </li>

        <li class="nav-item">
            <span class="nav-link">ğŸ­äººæ–‡è—è¡“å­¸é™¢ğŸ­ â–¾</span>
            <div class="dropdown-content">
                <a href="?cat=èªå‰µ">èªæ–‡èˆ‡å‰µä½œå­¸ç³»</a>
                <a href="?cat=å…’è‹±">å…’ç«¥è‹±èªæ•™è‚²å­¸ç³»</a>
                <a href="?cat=è—è¨­">è—è¡“èˆ‡é€ å½¢è¨­è¨ˆå­¸ç³»</a>
                <a href="?cat=éŸ³æ¨‚">éŸ³æ¨‚å­¸ç³»</a>
                <a href="?cat=æ–‡å‰µ">æ–‡åŒ–å‰µæ„ç”¢æ¥­ç¶“ç‡Ÿå­¸ç³»</a>
            </div>
        </li>

        <li class="nav-item">
            <span class="nav-link">âœ–ï¸ç†å­¸é™¢â— â–¾</span>
            <div class="dropdown-content">
                <a href="?cat=æ•¸è³‡">æ•¸å­¸æš¨è³‡è¨Šæ•™è‚²å­¸ç³»</a>
                <a href="?cat=è‡ªç„¶">è‡ªç„¶ç§‘å­¸æ•™è‚²å­¸ç³»</a>
                <a href="?cat=é«”è‚²">é«”è‚²å­¸ç³»</a>
                <a href="?cat=è³‡ç§‘">è³‡è¨Šç§‘å­¸ç³»</a>
                <a href="?cat=æ•¸ä½">æ•¸ä½ç§‘æŠ€è¨­è¨ˆå­¸ç³»</a>
            </div>
        </li>

        <li class="nav-item">
            <span class="nav-link">â“ å…¶ä»– â–¾</span>
            <div class="dropdown-content">
                <a href="?cat=é€šè­˜">é€šè­˜èª²ç¨‹</a>
                <a href="?cat=å…¶ä»–">å…¶ä»–å•é¡Œ</a>
            </div>
        </li>
    </ul>
</nav>

<div class="main-container">
    <div class="control-panel">
        <div id="status-bar">
            æ­£åœ¨ç€è¦½ï¼š<span id="category-name" style="font-weight: bold; font-size: 1.2em;">è¼‰å…¥ä¸­...</span>
        </div>

        <div class="topic-switcher">
            <input type="text" id="topic-input" class="topic-input" placeholder="è¼¸å…¥èª²åå»ºç«‹/æœå°‹è¨è«–ä¸²...">
            <button onclick="changeTopic()" class="btn-go">å‰å¾€</button>
            <button onclick="resetTopic()" class="btn-reset">é‡ç½®</button>
        </div>
        <p style="font-size: 0.8em; color: #666; margin-top: 8px; margin-bottom: 0;">
            è¼¸å…¥èª²ç¨‹åç¨±å¯åˆ‡æ›è‡³è©²èª²ç¨‹å°ˆå±¬è¨è«–å€ï¼Œç•™ç©ºå‰‡ç‚ºç³»æ‰€ä¸€èˆ¬é–’èŠã€‚
        </p>
    </div>

    <div class="forum-wrapper">
        <div class="giscus"></div>
    </div>
</div>

<footer>
    <div>
        <strong>æ ¡åœ’é¸èª²è©¢å•è«–å£‡</strong> &copy; 2025
    </div>
    <div style="margin-top: 10px; font-size: 0.9em;">
        è¯çµ¡ç®¡ç†å“¡ï¼š<a href="mailto:your-email@example.com">your-email@example.com</a>
    </div>
    <div class="footer-socials">
        <a href="https://github.com/garylin0909" target="_blank"><i class="fab fa-github"></i></a>
        <a href="#" target="_blank"><i class="fas fa-envelope"></i></a>
    </div>
</footer>

<script>
    // 1. å®šç¾©åˆ†é¡ Map
    const categoryMap = {
        'å…¬å‘Š': 'DIC_kwDOQzwF0c4C0lJA',
        'å…’è‹±': 'DIC_kwDOQzwF0c4C0lNi',
        'å…¶ä»–': 'DIC_kwDOQzwF0c4C0lN5',
        'å¹¼æ•™': 'DIC_kwDOQzwF0c4C0lNd',
        'å¿ƒè«®': 'DIC_kwDOQzwF0c4C0lNf',
        'æ•™ç¶“': 'DIC_kwDOQzwF0c4C0lNb',
        'æ•™è‚²': 'DIC_kwDOQzwF0c4C0lNc',
        'æ•¸ä½': 'DIC_kwDOQzwF0c4C0lNw',
        'æ•¸è³‡': 'DIC_kwDOQzwF0c4C0lNm',
        'æ–‡å‰µ': 'DIC_kwDOQzwF0c4C0lNl',
        'ç‰¹æ•™': 'DIC_kwDOQzwF0c4C0lNe',
        'ç¤¾ç™¼': 'DIC_kwDOQzwF0c4C0lNg',
        'è‡ªç„¶': 'DIC_kwDOQzwF0c4C0lNn',
        'è—è¨­': 'DIC_kwDOQzwF0c4C0lNj',
        'èªå‰µ': 'DIC_kwDOQzwF0c4C0lNh',
        'è³‡ç§‘': 'DIC_kwDOQzwF0c4C0lNv',
        'é€šè­˜': 'DIC_kwDOQzwF0c4C0lNx',
        'éŸ³æ¨‚': 'DIC_kwDOQzwF0c4C0lNk',
        'é«”è‚²': 'DIC_kwDOQzwF0c4C0lNo'
    };

    // 2. å–å¾—ç¶²å€åƒæ•¸
    const urlParams = new URLSearchParams(window.location.search);
    let cat = urlParams.get('cat');
    let topic = urlParams.get('topic'); // æ–°å¢ topic åƒæ•¸

    // 3. è¨­å®šé è¨­å€¼
    if (!cat || !categoryMap[cat]) {
        cat = 'å…¬å‘Š';
    }

    const targetId = categoryMap[cat];
    
    // 4. è¨­å®šé¡¯ç¤ºåç¨±èˆ‡ Term (ç”¨æ–¼å€åˆ†è¨è«–ä¸²)
    let displayName = cat + " è¨è«–å€";
    let term = cat + " - ä¸€èˆ¬è¨è«–å€"; // é è¨­ term

    if (topic && topic.trim() !== "") {
        displayName = cat + " - " + topic;
        term = cat + " - " + topic;
        // å°‡ç›®å‰çš„ topic å¡«å›è¼¸å…¥æ¡†ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…çŸ¥é“ç¾åœ¨åœ¨å“ª
        document.getElementById('topic-input').value = topic;
    }

    document.getElementById('category-name').textContent = displayName;

    // 5. åˆ‡æ›è¨è«–ä¸²çš„å‡½å¼
    function changeTopic() {
        const inputVal = document.getElementById('topic-input').value.trim();
        if (inputVal) {
            window.location.href = `?cat=${cat}&topic=${encodeURIComponent(inputVal)}`;
        } else {
            alert("è«‹è¼¸å…¥èª²ç¨‹åç¨±");
        }
    }

    function resetTopic() {
        window.location.href = `?cat=${cat}`;
    }

    // ç¶å®š Enter éµ
    document.getElementById('topic-input').addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            changeTopic();
        }
    });

    // 6. å‹•æ…‹è¼‰å…¥ Giscus (ä¿®æ”¹ mapping ç‚º term)
    const script = document.createElement('script');
    script.src = "https://giscus.app/client.js";
    script.setAttribute('data-repo', "garylin0909/forum");
    script.setAttribute('data-repo-id', "R_kgDOQzwF0Q");
    script.setAttribute('data-category-id', targetId);
    
    // é€™è£¡å¾ pathname æ”¹ç‚º termï¼Œé€™æ˜¯å¯¦ç¾å–®ä¸€é é¢å¤šè¨è«–ä¸²çš„é—œéµ
    script.setAttribute('data-mapping', "term");
    script.setAttribute('data-term', term); 
    
    script.setAttribute('data-strict', "0");
    script.setAttribute('data-reactions-enabled', "1");
    script.setAttribute('data-emit-metadata', "0");
    script.setAttribute('data-input-position', "top");
    script.setAttribute('data-theme', "preferred_color_scheme");
    script.setAttribute('data-lang', "zh-TW");
    script.setAttribute('crossorigin', "anonymous");
    script.async = true;
    document.body.appendChild(script);
</script>

</body>
</html>